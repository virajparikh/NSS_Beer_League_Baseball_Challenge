<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Bootstrap, from Twitter</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Beer League Project</title>

    <!-- Le styles -->
    <link href="assets/css/bootstrap.css" rel="stylesheet">
    <link href="assets/css/bootstrap-responsive.css" rel="stylesheet">    
    <link href="assets/css/custom.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="assets/ico/favicon.png">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
      $(document).ready(function() {
        // Get teams from database
        $.ajax({
          url: 'backliftapp/team',
          type: "GET",
          dataType: "json",
          success: function (data) {
            leagueAll = data;
            for (var i = 0; i < data.length; i++) {
              addTeamToTable(data[i]);
              //populateTeamList(data[i]);
            }; // End for()

            // Alerts Here =========================================================== /
            showAlerts();

            popTips(); // Fire bootstrap popover and tooltip function

          } // End success
        }); // End .ajax()

        

        // Call Boostrap functions
        $('.alert').alert();
        $('#mgrTip').tooltip();
        $('#tips').popover();
        $('#teamModal').on('shown', function () {
            $('#teamName').focus();
        }); //  End .on()

      }); // End doc.ready
       
        // BASEBALL SCRIPT ========================================================= -->
        var leagueAll = [];

        var team = {
          name: $("#teamName").val(),
          mgrFirst: $("#firstName").val(),
          mgrLast: $("#lastName").val(),
          mgrPhone: $("#phoneNum").val(),
          //mgrEmail: $("#email").val(),
          mgrZip: $("#zipCode").val(),
          sponsor: $("#sponsor").val(),
          wins: 0,
          losses: 0
        };

        // Add a team to The Beer League
        function addTeam() {

          var team = {
            name: $("#teamName").val(),
            mgrFirst: $("#firstName").val(),
            mgrLast: $("#lastName").val(),
            mgrPhone: $("#phoneNum").val(),
            //mgrEmail: $("#email").val(),
            mgrZip: $("#zipCode").val(),
            sponsor: $("#sponsor").val(),
            wins: 0,
            losses: 0
          };

          $.ajax({
            url: '/backliftapp/team',
            type: "POST",
            dataType: "json",
            data: team,
            success: function (data) {
              //console.dir(data);
              addTeamToTable(data);
              //populateTeamList(data); 
              clearForm();
              //popTips();
              showAlerts();              

            } // End success
          });

        }; // end add team

        // Edit team info
        function editTeam(id) {

          $('#edit').click(function() {
            $.ajax({
              url: '/backliftapp/team/' + id,
              type: "PUT",
              dataType: "json",
              data: team,
              success: function (data) {
                console.dir(data);
                addTeamToTable(data);
                //populateTeamList(data); 
                clearForm();
                popTips();
                }
            });
          }); // End .click()

        }; // End editTeam()

        function deleteTeam(id) {

          $('#cutTeam').click(function() {
            $.ajax({
              url: "backliftapp/team/" + id,
              type: "DELETE",
              dataType: "json",
              success: function () {
                $('#' + id).remove();
              }
            }); // End .ajax()
          }); // End .click()
        };

        function clearForm() {
          $(".team_inputs").each(function () {
            $(this).val("");
          });
        };

        // function populateTeamList(team) {
        //   $(
        //     "<h4 class='show'>" + team.name + " <em>sponsored by</em> " + team.sponsor + " </h4>" + 
        //     "<p class='more'>" +
        //     "Manager: " + team.mgrFirst + " " + team.mgrLast + "<br>" +
        //     "Phone: " + team.mgrPhone + "<br>" +
        //     "E-mail: " + team.mgrEmail + "<br>" +
        //     "<a class='manage deleteTeam'>Delete Team</a>" +
        //     "</p>").appendTo('#teamList');
        // }

        function addTeamToTable(team) {    
          $(
            "<tr id='" + team.id + "'>" +
            "<td>" + "<span id='teamPop' data-original-title='" + team.name + " Team Info' data-content='Mgr. Name: " + team.mgrFirst + " " + team.mgrLast + ", Phone: " + team.mgrPhone + ", Sponsor: " + team.sponsor + "'>" + team.name + "</span>" +
            "</td>" +
            "<td><span id='mgrTip' data-placement='left' data-original-title='" + team.mgrPhone + "'>" + team.mgrFirst + " " + team.mgrLast + "</span></td>" +
            "<td>" + team.wins + "</td>" +
            "<td>" + team.losses + "</td>" +
            "<td>" + ".000 %" + "</td>" +
            "<td>" + "<div class='btn-group'>" + "<a class='btn btn-small dropdown-toggle' data-toggle='dropdown' href='#'> Manage <span class='caret'></span></a>" + "<ul class='dropdown-menu'>" + 
              "<li>" + "<a href='#editTeam' data-toggle='modal'><i class='icon-edit'></i> Edit</a>" + "</li>" +
              "<li class='divider'>" + "</li>" +
              "<li>" + "<a href='#deleteConfirm' data-toggle='modal' onclick='deleteTeam(\"" + team.id + "\")'><i class='icon-remove'></i> Delete</a>" + "</li>" + 
            "</ul>" + "</div>" + "</td>" +
            "</tr>").appendTo('#standings tbody'
          );          
        }       

        // Call Bootstrap popover & tooltip functions 
        function popTips(id) { 
          $('#standings').popover({
            selector: "#teamPop",
            html: true
          });
          $('#standings').tooltip({
            selector: "#mgrTip",
            html: true
          });
        }

        function showAlerts() {
          $('#register').click(function() {
            if (leagueAll.length < 4) {
              $('#alert').append('<div class="alert alert-info alert-text">Beer league will be formed when a minimum of 4 teams have registered.</div>');
            }; // End if

            if (leagueAll.length >= 8){
              alert('There are 8 teams.');
              $('#addTeamBtn').hide();
              $('#alert').append('<div class="alert alert-danger alert-text">Registration is closed. All spots are filled!</div>');
            };
          }); // End .click()

        } // End showAlerts()
    </script>

  </head>
    <body>

      <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="#">The Beer League</a>
          <div class="nav-collapse collapse">

            <ul class="pull-right">
              <a id="addTeamBtn" href="#teamModal" role="button" class="btn btn-danger" data-toggle="modal">Add Team</a>
              <a href="#resultsModal" role="button" class="btn" data-toggle="modal">Update Results</a>
            </ul>

          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container">

      <div id="alert"></div>

      <div class="alert alert-success alert-text">Scores successfully updated! <a class="close" data-dismiss="alert" href="#">&times;</a></div>

      <!-- Main hero unit for a primary marketing message or call to action -->
      <div class="hero-unit">        

        <div class="text-center">
          <h1>Team Standings</h1>
          <br>
           
          <table id="standings" class="table table-striped">
            <thead>
              <tr>
                <th>Team</th>
                <th>Manager</th>
                <th>Wins</th>
                <th>Loses</th>
                <th>Season %</th>
                <th>Options</th>
              </tr>
            </thead>
            <tbody>              
              <!-- Table rows & data added by js function addTeamToTable -->
            </tbody>
          </table>

          <!-- <a href="#" id="teamPop" class="btn btn-large btn-danger" data-toggle="popover" title="" data-content="And here's some amazing content. It's very engaging. right?" data-original-title="A Title">Click to toggle popover</a> -->

        </div><!-- /.text-center -->

        <!-- ADD TEAM MODAL
        ================================ -->

        <div id="teamModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Batter up! <small>Register your team for the Beer Leagues</small></h3>
          </div>
          <div class="modal-body">

            <form id="addTeamForm" class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="teamName">Team:</label>
                <div class="controls">
                  <input type="text" id="teamName" class="team_inputs" name="teamName" placeholder="Team Name">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="manager">Manager:</label>
                <div class="controls">
                  <input type="text" id="firstName" class="team_inputs" name="firstName" placeholder="First Name">
                  <input type="text" id="lastName" class="team_inputs" name="lastName" placeholder="Last Name">
                  <input type="text" id="phoneNum" class="team_inputs" name="phoneNum" placeholder="Phone">
                  <input type="text" id="zipCode" class="team_inputs" name="zipCode" placeholder="Zip Code">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="inputSponsor">Sponsor:</label>
                <div class="controls">
                  <input type="text" id="sponsor" class="team_inputs" name="sponsor" placeholder="i.e. Recovery Spray">
                  <input type="hidden" id="sponsor" class="team_inputs" name="wins" value="0">
                  <input type="hidden" id="sponsor" class="team_inputs" name="loses" value="0">
                </div>
              </div>
            <form>

          </div>
          <div class="modal-footer">
            <button class="btn" type="reset">Clear</button>
            <button id="register" class="btn btn-success" data-dismiss="modal" aria-hidden="true" onclick="addTeam()">Add Team</button>
          </div>
        </div>


         <!-- EDIT TEAM MODAL
        ================================ -->

        <div id="editTeam" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Edit Your Team Info</h3>
          </div>
          <div class="modal-body">

            <form id="editTeamForm" class="form-horizontal">
              <div class="control-group">
                <label class="control-label" for="teamName">Team:</label>
                <div class="controls">
                  <input type="text" id="teamName" class="team_inputs" name="teamName" value="+ team.name + " placeholder="Team Name">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="manager">Manager:</label>
                <div class="controls">
                  <input type="text" id="firstName" class="team_inputs" name="firstName" placeholder="First Name">
                  <input type="text" id="lastName" class="team_inputs" name="lastName" placeholder="Last Name">
                  <input type="text" id="phoneNum" class="team_inputs" name="phoneNum" placeholder="Phone">
                  <input type="text" id="zipCode" class="team_inputs" name="zipCode" placeholder="Zip Code">
                </div>
              </div>

              <div class="control-group">
                <label class="control-label" for="inputSponsor">Sponsor:</label>
                <div class="controls">
                  <input type="text" id="sponsor" class="team_inputs" name="sponsor" placeholder="i.e. Recovery Spray">
                  <input type="hidden" id="sponsor" class="team_inputs" name="wins" value="0">
                  <input type="hidden" id="sponsor" class="team_inputs" name="loses" value="0">
                </div>
              </div>
            <form>

          </div>
          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
            <button id="edit" class="btn btn-success" data-dismiss="modal" aria-hidden="true" onclick="editTeam()">Update Team</button>
          </div>
        </div>


        <!-- DELETE CONFIRMATION MODAL
        ================================ -->
        <div id="deleteConfirm" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Looks like this team won't make the cut!</h3>
          </div>
          <div class="modal-body">
            <p>Are you sure you want to cut this team from the league?</p>
          </div>
          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
            <button id="cutTeam" class="btn btn-danger" data-dismiss="modal" aria-hidden="true">Delete</button>
          </div>
        </div>

        <!-- UPDATE RESULTS MODAL
        ================================ -->

        <div id="resultsModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">Update Team Scores</h3>
          </div>
          <div class="modal-body text-center">
            
            <select>
              <option>Cardinals vs Warriors</option>
              <option>Bears vs Brewers</option>
              <option>Braves vs Giants</option>
              <option>Dodgers vs Lions</option>
            </select>

            <input class="input-mini" type="text" placeholder="Team 1">

            <input class="input-mini" type="text" placeholder="Team 2">

          </div>
          <div class="modal-footer">
            <button class="btn btn-success">Update Scores</button>
          </div>
        </div>

      </div><!-- /.hero-unit -->

        <h2 class="text-center">Schedule/Results</h2>
        <br>

        <div class="row">
          <table class="table table-bordered span6">
              <thead>
                <tr>
                  <th>Week 1</th>
                  <th>Final Scores</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Cardinals vs Warriors</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Bears vs Brewers</td>
                  <td>0 - 0</td>            
                </tr>
                <tr>
                  <td>Braves vs Giants</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Dodgers vs Lions</td>
                  <td>0 - 0</td>            
                </tr>              
              </tbody>
            </table>

            <table class="table table-bordered span6">
              <thead>
                <tr>
                  <th>Week 2</th>
                  <th>Final Scores</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Cardinals vs Warriors</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Bears vs Brewers</td>
                  <td>0 - 0</td>            
                </tr>
                <tr>
                  <td>Braves vs Giants</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Dodgers vs Lions</td>
                  <td>0 - 0</td>            
                </tr>              
              </tbody>
            </table>
        </div>
        <br>

        <div class="row">
          <table class="table table-bordered span6">
              <thead>
                <tr>
                  <th>Week 3</th>
                  <th>Final Scores</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Cardinals vs Warriors</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Bears vs Brewers</td>
                  <td>0 - 0</td>            
                </tr>
                <tr>
                  <td>Braves vs Giants</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Dodgers vs Lions</td>
                  <td>0 - 0</td>            
                </tr>              
              </tbody>
            </table>

            <table class="table table-bordered span6">
              <thead>
                <tr>
                  <th>Week 4</th>
                  <th>Final Scores</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Cardinals vs Warriors</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Bears vs Brewers</td>
                  <td>0 - 0</td>            
                </tr>
                <tr>
                  <td>Braves vs Giants</td>
                  <td>0 - 0</td>           
                </tr>
                <tr>
                  <td>Dodgers vs Lions</td>
                  <td>0 - 0</td>            
                </tr>              
              </tbody>
            </table>
        </div>     
        
      <hr>

      <footer>
        <p>&copy; The Dream Team 2013</p>
      </footer>

    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    
    <script src="assets/js/bootstrap-alert.js"></script>
    <script src="assets/js/bootstrap-modal.js"></script>
    <script src="assets/js/bootstrap-dropdown.js"></script>
    <script src="assets/js/bootstrap-tooltip.js"></script>
    <script src="assets/js/bootstrap-popover.js"></script>
    <script src="assets/js/bootstrap-carousel.js"></script>
    <script src="assets/js/bootstrap-typeahead.js"></script>
    <script src="assets/js/bootstrap-transition.js"></script>
    <script src="assets/js/holder/holder.js"></script>

    </body>
  </html>